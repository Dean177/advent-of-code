open Core
open Toolbox

let input = String.to_list "649713959682898259577777982349515784822684939966191359164369933435366431847754488661965363557985166219358714739318371382388296151195361571216131925158492441461844687324923315381358331571577613789649166486152237945917987977793891739865149734755993241361886336926538482271124755359572791451335842534893192693558659991171983849285489139421425933638614884415896938914992732492192458636484523228244532331587584779552788544667253577324649915274115924611758345676183443982992733966373498385685965768929241477983727921279826727976872556315428434799161759734932659829934562339385328119656823483954856427365892627728163524721467938449943358192632262354854593635831559352247443975945144163183563723562891357859367964126289445982135523535923113589316417623483631637569291941782992213889513714525342468563349385271884221685549996534333765731243895662624829924982971685443825366827923589435254514211489649482374876434549682785459698885521673258939413255158196525696236457911447599947449665542554251486847388823576937167237476556782133227279324526834946534444718161524129285919477959937684728882592779941734186144138883994322742484853925383518651687147246943421311287324867663698432546619583638976637733345251834869985746385371617743498627111441933546356934671639545342515392536574744795732243617113574641284231928489312683617154536648219244996491745718658151648246791826466973654765284263928884137863647623237345882469142933142637583644258427416972595241737254449718531724176538648369253796688931245191382956961544775856872281317743828552629843551844927913147518377362266554334386721313244223233396453291224932499277961525785755863852487141946626663835195286762947172384186667439516367219391823774338692151926472717373235612911848773387771244144969149482477519437822863422662157461968444281972353149695515494992537927492111388193837553844671719291482442337761321272333982924289323437277224565149928416255435841327756139118119744528993269157174414264387573331116323982614862952264597611885999285995516357519648695594299657387614793341626318866519144574571816535351149394735916975448425618171572917195165594323552199346814729617189679698944337146"
let inputRotated = String.to_list "497139596828982595777779823495157848226849399661913591643699334353664318477544886619653635579851662193587147393183713823882961511953615712161319251584924414618446873249233153813583315715776137896491664861522379459179879777938917398651497347559932413618863369265384822711247553595727914513358425348931926935586599911719838492854891394214259336386148844158969389149927324921924586364845232282445323315875847795527885446672535773246499152741159246117583456761834439829927339663734983856859657689292414779837279212798267279768725563154284347991617597349326598299345623393853281196568234839548564273658926277281635247214679384499433581926322623548545936358315593522474439759451441631835637235628913578593679641262894459821355235359231135893164176234836316375692919417829922138895137145253424685633493852718842216855499965343337657312438956626248299249829716854438253668279235894352545142114896494823748764345496827854596988855216732589394132551581965256962364579114475999474496655425542514868473888235769371672374765567821332272793245268349465344447181615241292859194779599376847288825927799417341861441388839943227424848539253835186516871472469434213112873248676636984325466195836389766377333452518348699857463853716177434986271114419335463569346716395453425153925365747447957322436171135746412842319284893126836171545366482192449964917457186581516482467918264669736547652842639288841378636476232373458824691429331426375836442584274169725952417372544497185317241765386483692537966889312451913829569615447758568722813177438285526298435518449279131475183773622665543343867213132442232333964532912249324992779615257857558638524871419466266638351952867629471723841866674395163672193918237743386921519264727173732356129118487733877712441449691494824775194378228634226621574619684442819723531496955154949925379274921113881938375538446717192914824423377613212723339829242893234372772245651499284162554358413277561391181197445289932691571744142643875733311163239826148629522645976118859992859955163575196486955942996573876147933416263188665191445745718165353511493947359169754484256181715729171951655943235521993468147296171896796989443371466"

let isMatchingPair (l, r) = l = r

let%expect_test _ =  
  print_endline "Part 1";
  List.zip_exn input inputRotated
  |> List.filter ~f:isMatchingPair
  |> List.map ~f:fst 
  |> List.map ~f:Int.of_char
  |> List.sum
  |> Int.to_string
  |> print_endline;

  print_endline "Part 2";
  let midPoint = (List.length input) / 2 in
  let pairs = List.zip_exn input (List.concat [List.drop input midPoint;  List.take input midPoint]) in
  List.filter pairs ~f:isMatchingPair
  |> List.map ~f:fst
  |> List.map ~f:Int.of_char
  |> List.sum
  |> Int.to_string
  |> print_endline;

  [%expect {|
    Part 1
    1228
    Part 2
    1238 |}]
